<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Assignment2: N:/Documents/RTOS - CSC460/Assignments/Assignment2/Assignment2C/OS/os.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.6-NO -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<h1>N:/Documents/RTOS - CSC460/Assignments/Assignment2/Assignment2C/OS/os.c File Reference</h1>A Real Time Operating System. <a href="#_details">More...</a>
<p>
<code>#include &lt;avr/io.h&gt;</code><br>
<code>#include &lt;avr/interrupt.h&gt;</code><br>
<code>#include &quot;<a class="el" href="os_8h.html">os.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="kernel_8h.html">kernel.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="error__code_8h.html">error_code.h</a>&quot;</code><br>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os_8c.html#13f1ce8d1aeefce0b0d42cc7bad81fa1">USE_AVR2560_GREATER</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os_8c.html#dc80b18f37f24eb0f8bc27ca56e65d4b">STACKCONTEXTSIZE</a>&nbsp;&nbsp;&nbsp;(32 + 1 + 1 + 3 + 3)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os_8c.html#4ca901a3c767870093be57d271afc51e">KERNELARG_STACKOFFSET</a>&nbsp;&nbsp;&nbsp;(32 + 1 + 1 + 1)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os_8c.html#c8ed78dfc7cf1438e51909e988a8e6aa">SAVE_CTX_TOP</a>()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os_8c.html#dadefdf0cfb4066c6439cd200093c456">STACK_SREG_SET_I_BIT</a>()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os_8c.html#9250d18ad0a0ff5171eed2dc5f4e18d4">SAVE_CTX_BOTTOM</a>()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os_8c.html#d70a92eee8278b45f6aad877e23e0d3f">SAVE_CTX</a>()&nbsp;&nbsp;&nbsp;SAVE_CTX_TOP();SAVE_CTX_BOTTOM();</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Push all the registers and SREG onto the stack.  <a href="#d70a92eee8278b45f6aad877e23e0d3f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os_8c.html#6002f8099b24e6c7903df21a754f1d6b">RESTORE_CTX_BOTTOM</a>()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os_8c.html#c79aff233b9171c3cacaf6ddffe8014a">RESTORE_CTX_TOP</a>()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os_8c.html#a48fc0927da8c8abbe88e67573b389c9">RESTORE_CTX</a>()&nbsp;&nbsp;&nbsp;RESTORE_CTX_BOTTOM();RESTORE_CTX_TOP();</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pop all registers and the status register.  <a href="#a48fc0927da8c8abbe88e67573b389c9"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os_8c.html#e66f6b31b5ad750f1fe042a706a4e3d4">main</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">main function provided by user application. The first task to run.  <a href="#e66f6b31b5ad750f1fe042a706a4e3d4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os_8c.html#a5bea28826fceb06503c295132d2ac03">TIMER1_COMPA_vect</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The interrupt handler for output compare interrupts on Timer 1.  <a href="#a5bea28826fceb06503c295132d2ac03"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os_8c.html#280149a9407c6504ce0af541351561db">OS_Init</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Setup the RTOS and create <a class="el" href="_assignment2_8c.html#840291bc02cba5474a4cb46a9b9566fe">main()</a> as the first SYSTEM level task.  <a href="#280149a9407c6504ce0af541351561db"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os_8c.html#b5747390a8be675282cb93e5198bd085">OS_Abort</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Abort the execution of this RTOS due to an unrecoverable erorr.  <a href="#b5747390a8be675282cb93e5198bd085"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os_8c.html#d26f7e7c3185a703e89e97547747b03e">Task_Create</a> (void(*f)(void), int arg, unsigned int level, unsigned int name)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os_8c.html#5a9b72d0dadaea32fec8d4ff1c0eafa4">Task_Next</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The calling task gives up its share of the processor voluntarily.  <a href="#5a9b72d0dadaea32fec8d4ff1c0eafa4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os_8c.html#266ddbe2a3ded7e68eaa0d68a4047387">Task_Terminate</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The calling task terminates itself.  <a href="#266ddbe2a3ded7e68eaa0d68a4047387"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os_8c.html#dc48a5ac983c4656508f39c0ee65283f">Task_GetArg</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retrieve the assigned parameter.  <a href="#dc48a5ac983c4656508f39c0ee65283f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="os_8h.html#a280985b6f47e1541bbf5012bf62c450">EVENT</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os_8c.html#852c4f8ed9198c7c996cc5e9ce7f1f2b">Event_Init</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize a new, non-NULL Event descriptor.  <a href="#852c4f8ed9198c7c996cc5e9ce7f1f2b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os_8c.html#e279428ffa0e59261a01899cea931503">Event_Wait</a> (<a class="el" href="os_8h.html#a280985b6f47e1541bbf5012bf62c450">EVENT</a> *e)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Wait for the next occurrence of a signal on <em>e</em>. The calling process always blocks.  <a href="#e279428ffa0e59261a01899cea931503"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os_8c.html#39210e081be158dab105c68cb85585cd">Event_Signal</a> (<a class="el" href="os_8h.html#a280985b6f47e1541bbf5012bf62c450">EVENT</a> *e)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Resume a <b>single</b> waiting task on <em>e</em>. It is a <em>no-op</em> if there is no waiting process.  <a href="#39210e081be158dab105c68cb85585cd"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os_8c.html#93f9686857f1f8cc4fe1585df3de4874">Event_Broadcast</a> (<a class="el" href="os_8h.html#a280985b6f47e1541bbf5012bf62c450">EVENT</a> *e)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Resume <b>ALL</b> waiting tasks on <em>e</em>. It is a <em>no-op</em> if there is no waiting process.  <a href="#93f9686857f1f8cc4fe1585df3de4874"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os_8c.html#899044f5840427560c88d0d6e8944629">Signal_And_Next</a> (<a class="el" href="os_8h.html#a280985b6f47e1541bbf5012bf62c450">EVENT</a> *e)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Resume a waiting task on <em>e</em> and at the same time relinquish the processor.  <a href="#899044f5840427560c88d0d6e8944629"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os_8c.html#8530ed5f351b8835f3b060407bd68625">Broadcast_And_Next</a> (<a class="el" href="os_8h.html#a280985b6f47e1541bbf5012bf62c450">EVENT</a> *e)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Resume <b>ALL</b> waiting tasks on <em>e</em> and at the same time relinquish the processor.  <a href="#8530ed5f351b8835f3b060407bd68625"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os_8c.html#9139cb65cf60e47afed151765972c100">PPP</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os_8c.html#6370d00b2f49ebb4a69edf643003ada2">PT</a></td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
A Real Time Operating System. 
<p>
Our implementation of the operating system described by Mantis Cheng in <a class="el" href="os_8h.html">os.h</a>.<p>
<dl compact><dt><b>Author:</b></dt><dd>Scott Craig <p>
Justin Tanner </dd></dl>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="4ca901a3c767870093be57d271afc51e"></a><!-- doxytag: member="os.c::KERNELARG_STACKOFFSET" ref="4ca901a3c767870093be57d271afc51e" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define KERNELARG_STACKOFFSET&nbsp;&nbsp;&nbsp;(32 + 1 + 1 + 1)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a48fc0927da8c8abbe88e67573b389c9"></a><!-- doxytag: member="os.c::RESTORE_CTX" ref="a48fc0927da8c8abbe88e67573b389c9" args="()" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define RESTORE_CTX          </td>
          <td class="md" valign="top">(&nbsp;</td>
&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;RESTORE_CTX_BOTTOM();RESTORE_CTX_TOP();</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Pop all registers and the status register. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="6002f8099b24e6c7903df21a754f1d6b"></a><!-- doxytag: member="os.c::RESTORE_CTX_BOTTOM" ref="6002f8099b24e6c7903df21a754f1d6b" args="()" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define RESTORE_CTX_BOTTOM          </td>
          <td class="md" valign="top">(&nbsp;</td>
&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="c79aff233b9171c3cacaf6ddffe8014a"></a><!-- doxytag: member="os.c::RESTORE_CTX_TOP" ref="c79aff233b9171c3cacaf6ddffe8014a" args="()" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define RESTORE_CTX_TOP          </td>
          <td class="md" valign="top">(&nbsp;</td>
&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><div class="fragment"><pre class="fragment"><span class="keyword">asm</span> <span class="keyword">volatile</span> (\
    <span class="stringliteral">"pop    r31             \n\t"</span>\
        <span class="stringliteral">"out    __SREG__, r31   \n\t"</span>\
        <span class="stringliteral">"pop    r31             \n\t"</span>\
        <span class="stringliteral">"out    0X3C, r31       \n\t"</span>\
        <span class="stringliteral">"pop    r31             \n\t"</span>::);
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="d70a92eee8278b45f6aad877e23e0d3f"></a><!-- doxytag: member="os.c::SAVE_CTX" ref="d70a92eee8278b45f6aad877e23e0d3f" args="()" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define SAVE_CTX          </td>
          <td class="md" valign="top">(&nbsp;</td>
&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;SAVE_CTX_TOP();SAVE_CTX_BOTTOM();</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Push all the registers and SREG onto the stack. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="9250d18ad0a0ff5171eed2dc5f4e18d4"></a><!-- doxytag: member="os.c::SAVE_CTX_BOTTOM" ref="9250d18ad0a0ff5171eed2dc5f4e18d4" args="()" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define SAVE_CTX_BOTTOM          </td>
          <td class="md" valign="top">(&nbsp;</td>
&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="c8ed78dfc7cf1438e51909e988a8e6aa"></a><!-- doxytag: member="os.c::SAVE_CTX_TOP" ref="c8ed78dfc7cf1438e51909e988a8e6aa" args="()" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define SAVE_CTX_TOP          </td>
          <td class="md" valign="top">(&nbsp;</td>
&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><div class="fragment"><pre class="fragment"><span class="keyword">asm</span> <span class="keyword">volatile</span> (\
    <span class="stringliteral">"push   r31             \n\t"</span>\
    <span class="stringliteral">"in     r31,0X3C        \n\t"</span>\
    <span class="stringliteral">"push   r31             \n\t"</span>\
    <span class="stringliteral">"in     r31,__SREG__    \n\t"</span>\
        <span class="stringliteral">"cli                    \n\t"</span>::);
</pre></div>It is important to keep the order of context saving and restoring exactly in reverse. Also, when a new task is created, it is important to initialize its "initial" context in the same order as a saved context.<p>
Save r31 and SREG on stack, disable interrupts, then save the rest of the registers on the stack. In the locations this macro is used, the interrupts need to be disabled, or they already are disabled.     </td>
  </tr>
</table>
<a class="anchor" name="dadefdf0cfb4066c6439cd200093c456"></a><!-- doxytag: member="os.c::STACK_SREG_SET_I_BIT" ref="dadefdf0cfb4066c6439cd200093c456" args="()" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define STACK_SREG_SET_I_BIT          </td>
          <td class="md" valign="top">(&nbsp;</td>
&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><div class="fragment"><pre class="fragment"><span class="keyword">asm</span> <span class="keyword">volatile</span> (\
    <span class="stringliteral">"ori    r31, 0x80        \n\t"</span>::);
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="dc80b18f37f24eb0f8bc27ca56e65d4b"></a><!-- doxytag: member="os.c::STACKCONTEXTSIZE" ref="dc80b18f37f24eb0f8bc27ca56e65d4b" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define STACKCONTEXTSIZE&nbsp;&nbsp;&nbsp;(32 + 1 + 1 + 3 + 3)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="13f1ce8d1aeefce0b0d42cc7bad81fa1"></a><!-- doxytag: member="os.c::USE_AVR2560_GREATER" ref="13f1ce8d1aeefce0b0d42cc7bad81fa1" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define USE_AVR2560_GREATER&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="8530ed5f351b8835f3b060407bd68625"></a><!-- doxytag: member="os.c::Broadcast_And_Next" ref="8530ed5f351b8835f3b060407bd68625" args="(EVENT *e)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Broadcast_And_Next           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="os_8h.html#a280985b6f47e1541bbf5012bf62c450">EVENT</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>e</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Resume <b>ALL</b> waiting tasks on <em>e</em> and at the same time relinquish the processor. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>e</em>&nbsp;</td><td>an Event descriptor</td></tr>
  </table>
</dl>
This is equivalent to "Event_Broadcast( e ); Task_Next()" in concept. <dl compact><dt><b>See also:</b></dt><dd><a class="el" href="os_8c.html#93f9686857f1f8cc4fe1585df3de4874">Event_Broadcast()</a>, <a class="el" href="os_8c.html#5a9b72d0dadaea32fec8d4ff1c0eafa4">Task_Next()</a> </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="93f9686857f1f8cc4fe1585df3de4874"></a><!-- doxytag: member="os.c::Event_Broadcast" ref="93f9686857f1f8cc4fe1585df3de4874" args="(EVENT *e)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Event_Broadcast           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="os_8h.html#a280985b6f47e1541bbf5012bf62c450">EVENT</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>e</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Resume <b>ALL</b> waiting tasks on <em>e</em>. It is a <em>no-op</em> if there is no waiting process. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>e</em>&nbsp;</td><td>an Event descriptor</td></tr>
  </table>
</dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="os_8c.html#e279428ffa0e59261a01899cea931503">Event_Wait()</a> </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="852c4f8ed9198c7c996cc5e9ce7f1f2b"></a><!-- doxytag: member="os.c::Event_Init" ref="852c4f8ed9198c7c996cc5e9ce7f1f2b" args="(void)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="os_8h.html#a280985b6f47e1541bbf5012bf62c450">EVENT</a>* Event_Init           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Initialize a new, non-NULL Event descriptor. 
<p>
<dl compact><dt><b>Returns:</b></dt><dd>a non-NULL Event descriptor if successful; NULL otherwise. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="39210e081be158dab105c68cb85585cd"></a><!-- doxytag: member="os.c::Event_Signal" ref="39210e081be158dab105c68cb85585cd" args="(EVENT *e)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Event_Signal           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="os_8h.html#a280985b6f47e1541bbf5012bf62c450">EVENT</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>e</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Resume a <b>single</b> waiting task on <em>e</em>. It is a <em>no-op</em> if there is no waiting process. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>e</em>&nbsp;</td><td>an Event descriptor</td></tr>
  </table>
</dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="os_8c.html#e279428ffa0e59261a01899cea931503">Event_Wait()</a> </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="e279428ffa0e59261a01899cea931503"></a><!-- doxytag: member="os.c::Event_Wait" ref="e279428ffa0e59261a01899cea931503" args="(EVENT *e)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Event_Wait           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="os_8h.html#a280985b6f47e1541bbf5012bf62c450">EVENT</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>e</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Wait for the next occurrence of a signal on <em>e</em>. The calling process always blocks. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>e</em>&nbsp;</td><td>an Event descriptor </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="e66f6b31b5ad750f1fe042a706a4e3d4"></a><!-- doxytag: member="os.c::main" ref="e66f6b31b5ad750f1fe042a706a4e3d4" args="()" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int main           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
main function provided by user application. The first task to run. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b5747390a8be675282cb93e5198bd085"></a><!-- doxytag: member="os.c::OS_Abort" ref="b5747390a8be675282cb93e5198bd085" args="(void)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void OS_Abort           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Abort the execution of this RTOS due to an unrecoverable erorr. 
<p>
Abort the execution of this RTOS due to an unrecoverable erorr. <dl compact><dt><b>See also:</b></dt><dd><a class="el" href="index.html#assumptions">GLOBAL ASSUMPTIONS</a>. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="280149a9407c6504ce0af541351561db"></a><!-- doxytag: member="os.c::OS_Init" ref="280149a9407c6504ce0af541351561db" args="()" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void OS_Init           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Setup the RTOS and create <a class="el" href="_assignment2_8c.html#840291bc02cba5474a4cb46a9b9566fe">main()</a> as the first SYSTEM level task. 
<p>
Point of entry from the C runtime crt0.S.     </td>
  </tr>
</table>
<a class="anchor" name="899044f5840427560c88d0d6e8944629"></a><!-- doxytag: member="os.c::Signal_And_Next" ref="899044f5840427560c88d0d6e8944629" args="(EVENT *e)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Signal_And_Next           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="os_8h.html#a280985b6f47e1541bbf5012bf62c450">EVENT</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>e</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Resume a waiting task on <em>e</em> and at the same time relinquish the processor. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>e</em>&nbsp;</td><td>an Event descriptor</td></tr>
  </table>
</dl>
This is equivalent to "Event_Signal( e ); Task_Next()" in concept. The fundamental difference is that these two operations are performed as an indivisible unit. So conceptually, the calling task resumes another waiting task and gives up its share of the processor simultaneously. <dl compact><dt><b>See also:</b></dt><dd><a class="el" href="os_8c.html#39210e081be158dab105c68cb85585cd">Event_Signal()</a>, <a class="el" href="os_8c.html#5a9b72d0dadaea32fec8d4ff1c0eafa4">Task_Next()</a> </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="d26f7e7c3185a703e89e97547747b03e"></a><!-- doxytag: member="os.c::Task_Create" ref="d26f7e7c3185a703e89e97547747b03e" args="(void(*f)(void), int arg, unsigned int level, unsigned int name)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int Task_Create           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void(*)(void)&nbsp;</td>
          <td class="mdname" nowrap> <em>f</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>arg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int&nbsp;</td>
          <td class="mdname" nowrap> <em>level</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int&nbsp;</td>
          <td class="mdname" nowrap> <em>name</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>f</em>&nbsp;</td><td>a parameterless function to be created as a process instance </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>arg</em>&nbsp;</td><td>an integer argument to be assigned to this process instanace </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>level</em>&nbsp;</td><td>assigned scheduling level: SYSTEM, PERIODIC or RR </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>name</em>&nbsp;</td><td>assigned PERIODIC process name </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>0 if not successful; otherwise non-zero. </dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="os_8c.html#dc48a5ac983c4656508f39c0ee65283f">Task_GetArg()</a>, <a class="el" href="os_8h.html#9139cb65cf60e47afed151765972c100">PPP</a>[].</dd></dl>
A new process is created to execute the parameterless function <em>f</em> with an initial parameter <em>arg</em>, which is retrieved by a call to <a class="el" href="os_8c.html#dc48a5ac983c4656508f39c0ee65283f">Task_GetArg()</a>. If a new process cannot be created, 0 is returned; otherwise, it returns non-zero. The created process will belong to its scheduling <em>level</em>. If the process is PERIODIC, then its <em>name</em> is a user-specified name to be used in the PPP[] array. Otherwise, <em>name</em> is ignored. <dl compact><dt><b>See also:</b></dt><dd><a class="el" href="index.html#policy">SCHEDULING POLICY</a> </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="dc48a5ac983c4656508f39c0ee65283f"></a><!-- doxytag: member="os.c::Task_GetArg" ref="dc48a5ac983c4656508f39c0ee65283f" args="(void)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int Task_GetArg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Retrieve the assigned parameter. 
<p>
Retrieve the assigned parameter. <dl compact><dt><b>See also:</b></dt><dd><a class="el" href="os_8c.html#d26f7e7c3185a703e89e97547747b03e">Task_Create()</a>. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="5a9b72d0dadaea32fec8d4ff1c0eafa4"></a><!-- doxytag: member="os.c::Task_Next" ref="5a9b72d0dadaea32fec8d4ff1c0eafa4" args="()" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Task_Next           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The calling task gives up its share of the processor voluntarily. 
<p>
Voluntarily relinquish the processor.     </td>
  </tr>
</table>
<a class="anchor" name="266ddbe2a3ded7e68eaa0d68a4047387"></a><!-- doxytag: member="os.c::Task_Terminate" ref="266ddbe2a3ded7e68eaa0d68a4047387" args="()" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Task_Terminate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The calling task terminates itself. 
<p>
Terminate the calling process<p>
When a process returns, i.e., it executes its last instruction in the associated function/code, it is automatically terminated.     </td>
  </tr>
</table>
<a class="anchor" name="a5bea28826fceb06503c295132d2ac03"></a><!-- doxytag: member="os.c::TIMER1_COMPA_vect" ref="a5bea28826fceb06503c295132d2ac03" args="(void)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">TIMER1_COMPA_vect           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The interrupt handler for output compare interrupts on Timer 1. 
<p>
Used to enter the kernel when a tick expires.<p>
Assumption: We are still executing on the cur_task stack. The return address inside the current task code is on the top of the stack.<p>
The "naked" attribute prevents the compiler from adding instructions to save and restore register values. It also prevents an automatic return instruction.     </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="9139cb65cf60e47afed151765972c100"></a><!-- doxytag: member="os.c::PPP" ref="9139cb65cf60e47afed151765972c100" args="[]" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const unsigned char <a class="el" href="os_8h.html#9139cb65cf60e47afed151765972c100">PPP</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
PPP and PT defined in user application.     </td>
  </tr>
</table>
<a class="anchor" name="6370d00b2f49ebb4a69edf643003ada2"></a><!-- doxytag: member="os.c::PT" ref="6370d00b2f49ebb4a69edf643003ada2" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const unsigned int <a class="el" href="os_8h.html#6370d00b2f49ebb4a69edf643003ada2">PT</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
PPP and PT defined in user application.     </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Mon Jun 14 23:02:13 2010 for Assignment2 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.6-NO </small></address>
</body>
</html>
